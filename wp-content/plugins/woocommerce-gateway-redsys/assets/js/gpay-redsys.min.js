function getGoogleIsReadyToPayRequest(){return Object.assign({},baseRequest,{allowedPaymentMethods:[baseCardPaymentMethod]})}function getGooglePaymentDataRequest(){const e=Object.assign({},baseRequest);return e.allowedPaymentMethods=[cardPaymentMethod],e.transactionInfo=getGoogleTransactionInfo(),e.merchantInfo={merchantId:VarmerchantId,merchantName:VarmerchantName,merchantOrigin:VarmerchantOrigin},e}function getGooglePaymentsClient(){return null===paymentsClient&&(paymentsClient=new google.payments.api.PaymentsClient({environment:Varenvironment})),paymentsClient}function onGooglePayLoaded(){const e=getGooglePaymentsClient();e.isReadyToPay(getGoogleIsReadyToPayRequest()).then(function(e){e.result&&addGooglePayButton()}).catch(function(e){console.error(e)})}function addGooglePayButton(){const e=getGooglePaymentsClient(),t=e.createButton({onClick:onGooglePaymentButtonClicked,buttonColor:VarButtonColor,buttonType:VarbuttonType,buttonLocale:VarbuttonLocale,buttonSizeMode:"fill"});setTimeout(function(){document.getElementById("redsys-gpay-button").appendChild(t)},VartimeLoadButton)}function getGoogleTransactionInfo(){return jQuery.ajax({url:url_site+"/?wc-api=WC_Gateway_googlepayredsys&checkout-price=true",method:"GET",dataType:"json",async:!1,success:function(e){e&&e.total&&(VartotalPrice=e.total)},error:function(e){console.error("Error fetching updated total:",e)}}),{countryCode:VarcountryCode,currencyCode:VarcurrencyCode,totalPriceStatus:VartotalPriceStatus,totalPrice:VartotalPrice}}function prefetchGooglePaymentData(){const e=getGooglePaymentDataRequest();e.transactionInfo={totalPriceStatus:"NOT_CURRENTLY_KNOWN",currencyCode:VarcurrencyCode};const t=getGooglePaymentsClient();t.prefetchPaymentData(e)}function onGooglePaymentButtonClicked(){const e=getGooglePaymentDataRequest();e.transactionInfo=getGoogleTransactionInfo();const t=getGooglePaymentsClient();t.loadPaymentData(e).then(function(e){processPayment(e)}).catch(function(e){console.error(e)})}function processPayment(e){console.log(e);var t=e.paymentMethodData.tokenizationData.token;document.getElementById("gpay-token-redsys").value=btoa(t),t&&document.getElementById("place_order").click(),console.log(t)}var VargatewayMerchantId=gpay_redsys.gatewayMerchantId,VarmerchantId=gpay_redsys.merchantId,VarmerchantName=gpay_redsys.merchantName,VarmerchantOrigin=gpay_redsys.merchantOrigin,Varenvironment=gpay_redsys.environment,VarcountryCode=gpay_redsys.countryCode,VarcurrencyCode=gpay_redsys.currencyCode,VartotalPriceStatus=gpay_redsys.totalPriceStatus,VartotalPrice=gpay_redsys.totalPrice,VartimeLoadButton=gpay_redsys.timeLoadButton,url_site=gpay_redsys.url_site,VarButtonColor=gpay_redsys.buttonColor,VarbuttonType=gpay_redsys.buttonType,VarbuttonLocale=gpay_redsys.buttonLocale;const baseRequest={apiVersion:2,apiVersionMinor:0},allowedCardNetworks=["AMEX","DISCOVER","JCB","MASTERCARD","VISA"],allowedCardAuthMethods=["PAN_ONLY","CRYPTOGRAM_3DS"],tokenizationSpecification={type:"PAYMENT_GATEWAY",parameters:{gateway:"redsys",gatewayMerchantId:VargatewayMerchantId}},baseCardPaymentMethod={type:"CARD",parameters:{allowedAuthMethods:allowedCardAuthMethods,allowedCardNetworks:allowedCardNetworks}},cardPaymentMethod=Object.assign({},baseCardPaymentMethod,{tokenizationSpecification:tokenizationSpecification});let paymentsClient=null;