!function(){"use strict";let g=null,c="permanent";const b=a=>{const b=[...a?.querySelectorAll(":scope > .otter-form__container .wp-block-themeisle-blocks-form")];return[...a?.querySelectorAll(":scope > .otter-form__container .wp-block-themeisle-blocks-form-input, :scope > .otter-form__container .wp-block-themeisle-blocks-form-textarea, :scope > .otter-form__container .wp-block-themeisle-blocks-form-multiple-choice, :scope > .otter-form__container .wp-block-themeisle-blocks-form-file, :scope > .otter-form__container .wp-block-themeisle-blocks-form-hidden-field, :scope > .otter-form__container .wp-block-themeisle-blocks-form-stripe-field")].filter(a=>!b?.some(b=>b?.contains(a)))},d=(c,a,d,b,e)=>{c.then(a=>a.json()).then(f=>{const c=f;if("0"===c?.code||"1"===c?.code||c?.success)d?.(c,a);else{let d="";"110"===c.code?a.setMsg(c?.reasons?.join(""),"error").show():"12"===c.code||"13"===c.code?a.pullMsg("invalid-file","error").show():0<c?.displayError?.length?(d=c?.displayError,a.setMsg(d,"error").show()):a.setMsg(c?.reasons?.join(""),"error").show(),b?.(c,a),console.error(`(${c?.code}) ${c?.reasons?.join("")}`)}e?.()})?.catch(c=>{console.error(c),a.pullMsg("try-again","error").show(),b?.(c,a)})},e=b=>{const a=document.createElement("span");return a.classList.add("spinner"),{show:()=>{b.appendChild(a)},hide:()=>{b.removeChild(a)}}},f=async(a,h,k)=>{const j=a?.id,f={},{formFieldsData:p}=await(async d=>{const a=[{label:window?.themeisleGutenbergForm?.messages["form-submission"]||"Form submission from",value:window.location.href,metadata:{position:0}}],e=b(d);return e?.forEach((b,i)=>{const h=b.querySelector(".otter-form-input-label"),k=(null!=h?h:b).querySelector(".otter-form-input-label__label, .otter-form-textarea-label__label"),l=`(Field ${i+1})`;let d,f,e,j=`${l} ${(null!=k?k:h)?.innerHTML?.replace(/<[^>]*>?/gm,"")}`,m={};const{id:n}=b,g=b.querySelector('.otter-form-input:not([type="checkbox"], [type="radio"], [type="file"], [type="hidden"]), .otter-form-textarea-input');if(null!==g)d=g?.value,f=g?.type,e=g?.name;else{const k=b.querySelector("select");e=k?.name;const h=b.querySelector('input[type="file"]'),g=b.querySelector('input[type="hidden"]'),o=b.classList.contains("wp-block-themeisle-blocks-form-stripe-field");if(h){const b=h?.files,c=h?.name;for(let d=0;d<b.length;d++)a.push({label:j,value:`${b[d].name} (${(b[d].size/1048576).toFixed(4)} MB)`,type:h.type,id:n,metadata:{version:1,name:b[d].name,size:b[d].size,file:b[d],fieldOptionName:h?.dataset?.fieldOptionName,position:i+1,mappedName:c}})}else if(k)d=[...k.selectedOptions].map(a=>a?.label)?.filter(a=>Boolean(a)).join(", "),f="multiple-choice";else if(g){const a=g?.dataset?.paramName;if(e=g?.name,a){const b=new URLSearchParams(window.location.search);b.has(a)&&(g.value=b.get(a))}g?.value&&(d=g.value,f="hidden")}else if(o)j=`${l} ${b.querySelector(".o-stripe-checkout-description h3")?.innerHTML?.replace(/<[^>]*>?/gm,"")}`,d=b.querySelector(".o-stripe-checkout-description h5")?.innerHTML?.replace(/<[^>]*>?/gm,""),f="stripe-field",e=b.name,m={fieldOptionName:b?.dataset?.fieldOptionName},c="temporary";else{const c=b.querySelectorAll(".o-form-multiple-choice-field > label"),a=b.querySelectorAll(".o-form-multiple-choice-field > input");e=a[0]?.name,d=[...c].filter((c,b)=>a[b]?.checked).map(a=>a.innerHTML).join(", "),f="multiple-choice"}}d&&a.push({label:j||"(No label)",value:d,type:f,id:n,metadata:{...m,version:1,position:i+1,mappedName:e}})}),{formFieldsData:a}})(a),r=2>p?.length,q=function(a){const b=`.protection #${a.id||""}_nonce_field`;return a.querySelector(b)?.value}(a),o=a?.classList?.contains("has-captcha"),m=j&&window.themeisleGutenberg?.tokens?.[j]?.token,i=e(h);if(r)return h.disabled=!1,void i.hide();const s=function(c){let a=!0;const d=b(c);for(const b of d)if(b.classList.contains("wp-block-themeisle-blocks-form-input")){{const c=b.querySelector("input");if(!c?.checkValidity()){c?.reportValidity(),a=!1;break}}}else if(b.classList.contains("wp-block-themeisle-blocks-form-textarea")){{const c=b.querySelector("textarea");if(!c?.checkValidity()){c?.reportValidity(),a=!1;break}}}else if(b.classList.contains("wp-block-themeisle-blocks-form-multiple-choice")){{const e=b.querySelector("select");if(e?.hasAttribute("required")&&!e?.checkValidity()){e?.reportValidity(),a=!1;break}const c=b.querySelectorAll('.o-form-multiple-choice-field input[type="radio"]');if(c?.length&&c[0]?.hasAttribute("required")&&![...c].some(a=>a.checked)){c[0]?.reportValidity(),a=!1;break}const d=b.querySelectorAll('.o-form-multiple-choice-field input[type="checkbox"]');if(d?.length&&d[0]?.hasAttribute("required")&&![...d].some(a=>a.checked)){d[0]?.reportValidity(),a=!1;break}}}else if(b.classList.contains("wp-block-themeisle-blocks-form-file")){const c=b.querySelector("input");if(!c?.checkValidity()){c?.reportValidity(),a=!1;break}}return a}(a);if(o&&!m){const a=window.hasOwnProperty("grecaptcha")?"check-captcha":"captcha-not-loaded";k.pullMsg(a,"error").show()}if(!s||o&&!m)h.disabled=!1,h.removeChild(i);else{var l,n;f.formInputsData=p,m&&(f.token=window.themeisleGutenberg?.tokens?.[j].token),""!==a?.dataset?.emailSubject&&(f.emailSubject=a?.dataset?.emailSubject),a?.dataset?.optionName&&(f.formOption=a?.dataset?.optionName),a?.id&&(f.formId=a?.id),q&&(f.nonceValue=q),f.antiSpamTime=Date.now()-(null!==(l=g)&&void 0!==l?l:Date.now()),f.antiSpamHoneyPot=Boolean(null!==(n=a.querySelector(":scope > .otter-form__container > .protection .o-anti-bot")?.checked)&&void 0!==n&&n),f.postUrl=window.location.href,f.postId=(()=>{const b=document.querySelector("body"),c=b?.classList?.value?.split(" "),a=c?.find(a=>a.includes("postid-")||a.includes("page-id-"));if(a){const b=a.split("-").pop();if(b)return parseInt(b)}return 0})(),a.classList.contains("can-submit-and-subscribe")&&(f.action="submit-subscribe",f.consent=a.querySelector(".otter-form-consent input")?.checked||!1);const b=(window?.themeisleGutenbergForm?.root||window.location.origin+"/wp-json/")+"otter/v1/form/frontend",e=(a=>{var b=new FormData;return a?.payload?.formInputsData?.forEach((c,d)=>{if("file"===c.type){let e="file__"+c.metadata.position+"_"+d;b.append(e,c.metadata.file),a.payload.formInputsData[d].metadata.file=void 0,a.payload.formInputsData[d].metadata.data=e}}),b.append("form_data",JSON.stringify(a)),b})({handler:"submit",payload:f});try{const f=fetch(b,{method:"POST",headers:{"X-WP-Nonce":window?.themeisleGutenbergForm?.nonce,"O-Form-Save-Mode":c},credentials:"include",body:e});i.show(),d(f,k,(b,c)=>{if(0<b?.frontend_external_confirmation_url?.length)return void window.open(b.frontend_external_confirmation_url,"_blank");const d=b?.submitMessage?b.submitMessage:"Success";c.setMsg(d).show(),a?.querySelector("form")?.reset(),0<b?.redirectLink?.length&&(a.setAttribute("data-redirect",b.redirectLink),setTimeout(()=>{window.location.href=b.redirectLink},1e3))},(a,b)=>{},()=>{window.themeisleGutenberg?.tokens?.[j].reset&&window.themeisleGutenberg?.tokens?.[j].reset(),h.disabled=!1,i.hide()})}catch(a){console.error(a),k.pullMsg("try-again","error").show(),h.disabled=!1,i.hide()}}};var a;a=()=>{const a=document.querySelectorAll(".wp-block-themeisle-blocks-form");(a=>{if(!window.hasOwnProperty("grecaptcha")&&window?.themeisleGutenbergForm?.reRecaptchaSitekey){const b=document.createElement("script");b.id="recaptcha",document.body.appendChild(b),b.addEventListener("load",()=>{const b=setInterval(()=>{window.hasOwnProperty("grecaptcha")&&window.grecaptcha.hasOwnProperty("render")&&(a.forEach(a=>{a?.classList?.contains("has-captcha")&&(a=>{if(!window.hasOwnProperty("grecaptcha"))return;const{id:b}=a,c=document.createElement("div"),d=a.querySelector(".otter-form__container");d?.insertBefore(c,d.lastChild);const e=window.grecaptcha?.render(c,{sitekey:window?.themeisleGutenbergForm?.reRecaptchaSitekey,callback:a=>{window.themeisleGutenberg||(window.themeisleGutenberg={}),window.themeisleGutenberg?.tokens||(window.themeisleGutenberg.tokens={}),window.themeisleGutenberg.tokens[b]={token:a,reset:()=>window.grecaptcha?.reset(e)}},"expired-callback":()=>{window.themeisleGutenberg?.tokens||(window.themeisleGutenberg={},window.themeisleGutenberg.tokens={}),window.themeisleGutenberg.tokens[b]={token:null,reset:()=>null}}})})(a)}),clearInterval(b))},200)}),b.src=window?.themeisleGutenbergForm?.reRecaptchaAPIURL}})(a),g=Date.now(),a.forEach(b=>{b.classList.contains("can-submit-and-subscribe")&&(d=>{const e=d.querySelector(".otter-form__container"),f=d.querySelector(".wp-block-button"),a=document.createElement("div");a.classList.add("otter-form-consent"),e.insertBefore(a,f);const b=document.createElement("input");b.type="checkbox",b.name="o-consent",b.id="o-consent";const c=document.createElement("label");c.innerHTML=window?.themeisleGutenbergForm?.messages?.privacy||"I have read and agreed the privacy statement.",c.htmlFor="o-consent",a.appendChild(b),a.appendChild(c)})(b);const a=b.querySelector("button"),c=new class{constructor(a){this.form=a,this.anchor=a.querySelector(".wp-block-button"),this.anchor?.classList.add("has-submit-msg"),this.msgElem=document.createElement("div"),this.msgElem.classList.add("o-form-server-response"),this.anchor.appendChild(this.msgElem),this.isVisible=!1,this.visibilityTimeout=void 0,this.visibilityDuration=12e3}toggle(a){this.isVisible=void 0!==a?a:!this.isVisible,this.msgElem.style.display=this.isVisible?"block":"none"}getMsgBySlug(a){return window?.themeisleGutenbergForm?.messages[a]||"Messages are missing!"}pullMsg(a,b){return this.setMsg(this.getMsgBySlug(a),b)}setMsg(a,b=""){switch(this.msgElem.innerHTML=a,this.clean(),b){case"error":this.msgElem.classList.toggle("o-error",!0);break;case"warning":this.msgElem.classList.toggle("o-warning",!0);break;default:this.msgElem.classList.toggle("o-success",!0)}return this}show(a){clearTimeout(this.visibilityTimeout),this.toggle(!0),this.visibilityTimeout=setTimeout(()=>{this.toggle(!1)},a||this.visibilityDuration)}clean(){this.msgElem.classList.toggle("o-error",!1),this.msgElem.classList.toggle("o-warning",!1),this.msgElem.classList.toggle("o-success",!1)}}(b);if(new URLSearchParams(window.location.search).has("stripe_checkout")){a.disabled=!0;const g=a.innerHTML;a.innerHTML=c.getMsgBySlug("confirmingSubmission");const f=e(a);f.show(),d((async()=>{const a=new URLSearchParams(window.location.search).get("stripe_checkout"),b=(window?.themeisleGutenbergForm?.root||window.location.origin+"/wp-json/")+"otter/v1/form/confirm";return await fetch(b+`?stripe_checkout=${a}`,{method:"GET",credentials:"include"})})(),c,(a,c)=>{const d=a?.submitMessage?a.submitMessage:"Success";c.setMsg(d).show(),0<a?.redirectLink?.length&&(b.setAttribute("data-redirect",a.redirectLink),setTimeout(()=>{window.location.href=a.redirectLink},1e3))},()=>{},()=>{a.disabled=!1,f.hide(),a.innerHTML=g})}b.querySelector(':scope > form > button[type="submit"]')?b?.addEventListener("submit",d=>{d.preventDefault(),a.disabled||(a.disabled=!0,f(b,a,c))},!1):a?.addEventListener("click",d=>{d.preventDefault(),a.disabled||(a.disabled=!0,f(b,a,c))},!1)}),a.forEach(a=>{b(a).forEach(b=>{const a=b.querySelector("input");if("file"===a?.type){const{maxFilesNumber:b,maxFileSize:c}=a.dataset;a.addEventListener("change",f=>{let d=!0;const{files:e}=f.target;if(b&&e.length>b&&(a.setCustomValidity(window.themeisleGutenbergForm?.messages?.["too-many-files"]+b),d=!1),d&&c)for(const b of e)if(b.size>1024*c*1024){a.setCustomValidity(window.themeisleGutenbergForm?.messages?.["big-file"]+" "+c+"MB."),d=!1;break}d?a.setCustomValidity(""):(a.reportValidity(),a.value="")})}})})},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",a):a())}()